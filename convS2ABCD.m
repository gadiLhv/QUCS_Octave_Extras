function M = convS2ABCD(S,Z0)

A = ((1 + S(1,1,:)).*(1 - S(2,2,:)) + S(1,2,:).*S(2,1,:))./(2*S(2,1,:));
B = ((1 + S(1,1,:)).*(1 + S(2,2,:)) - S(1,2,:).*S(2,1,:))*Z0./(2*S(2,1,:));
C = ((1 - S(1,1,:)).*(1 - S(2,2,:)) - S(1,2,:).*S(2,1,:))*(1/Z0)./(2*S(2,1,:));
D = ((1 - S(1,1,:)).*(1 + S(2,2,:)) + S(1,2,:).*S(2,1,:))./(2*S(2,1,:));    

M = [[A B] ; [C D]];

end